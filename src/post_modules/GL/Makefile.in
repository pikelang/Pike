# $Id$
@make_variables@
VPATH=@srcdir@:@srcdir@/../..:../..
MODULE_CPPFLAGS=@DEFS@
OBJS=top.o @AUTO_OBJS@
MODULE_LDFLAGS=@LDFLAGS@ @LIBS@
CONFIG_HEADERS=@CONFIG_HEADERS@
MODULE_CFLAGS=@X_CFLAGS@

override:
	@$(MAKE) \
	  CFLAGS="`echo $(CFLAGS) | sed -e 's/-g//g' -e 's/-W[^ ]*//g' -e 's/-O[^ ]*//g'` -O" \
	  all

@dynamic_module_makefile@

$(SRCDIR)/auto.c : $(SRCDIR)/auto.c.in $(SRCDIR)/features.pike $(SRCDIR)/constants.pike $(SRCDIR)/gen.pike
	$(RUNPIKE) $(SRCDIR)/gen.pike < $(SRCDIR)/auto.c.in > $(SRCDIR)/auto.c

# Compatibility with stupid makes..
auto.o: $(SRCDIR)/auto.c

@dependencies@
